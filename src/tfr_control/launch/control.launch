<launch>
    <!-- Load all of the motor controllers -->
    <rosparam file="$(find tfr_control)/config/controllers.yaml" command="load"/>

    <param name="robot_description" textfile="$(find tfr_description)/urdf_2021/urdf/urdf_v2.urdf" />

    <!-- Publishes the state of the robot to TF for Rviz or other usages -->
    <node name="joint_state_publisher" pkg="joint_state_publisher"
        type="joint_state_publisher">
      <param name="use_gui" value="FALSE"/>
    </node>

    <node name="drivebase" pkg="tfr_control" type="drivebase" output="screen">
        <param name="wheel_span"  value="0.72"/> 
        <param name="wheel_radius" value="0.15"/> 
    </node>

    <!-- Load the controller manager plugin for the drivebase -->
    <node name="control" pkg="tfr_control" type="control" output="screen">
        <rosparam>
            rate: 16 <!-- Keep this rate low, or zeros will sneak into drivebase commands-->
        </rosparam>
    </node>
	
    <!-- Spawn the controllers -->
    <node name="controller_spawner" pkg="controller_manager" type="spawner"
        args="joint_state_controller
        left_tread_velocity_controller
        right_tread_velocity_controller
        bin_position_controller
        arm_controller
        arm_end_controller"/>
	
	<param name="left_tread_scale" value="1" type="int"/>
	<param name="right_tread_scale" value="1" type="int"/>
	<param name="/write_arm_values" value="false" type="bool"/>

    <!-- Launch all the MoveIt! nodes -->
    <include file="$(find tfr_moveit)/launch/move_group.launch"/>
    
    <node name="arm_action_server" pkg="tfr_control" type="arm_action_server" output="screen"/>
</launch>
